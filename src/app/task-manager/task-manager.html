<div class="task-manager-container">
<!--header section starts-->
<div class="header-section">
    <h1>{{'Task Manager'}}</h1>
    <p class="header-subtitle">
        Web by Tejas
    </p>
</div>

<!--Statastics Cards Start-->
<div class="stats-container">
    <div class="stat-card">
        <div class="stat-label">Total tasks</div>
        <div class="stat-value">{{tasks.length}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Completed</div>
        <div class="stat-value">{{getCompletedTaskCount()}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Pending</div>
        <div class="stat-value">{{getPendingTaskCount()}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Overdue</div>
        <div class="stat-value">{{getOverdueTaskCount()}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Completion RAte</div>
        <div class="stat-value" [style.color]="getCompletionRate() > 70 ? '#10b981' : getCompletionRate()
            > 40 ? '#f59e0b' : '#ef4444'">{{getCompletionRate()}}%</div>
    </div>
</div>
<!--Statastics Cards end-->

<!--Quick action bars starts-->
<div class="quick-actions">
<select class="filter-dropdown" [(ngModel)]="filterStatus">
    <option value="all">All Status</option>
    @for (status of statuses; track status) {
        <option value="status">{{status}}</option>
    }
</select>

<select class="filter-dropdown" [(ngModel)]="filterCategory">
    <option value="all">All Category</option>
    @for (category of categories; track category) {
        <option value="category">{{category}}</option>
    }
</select>

<select class="filter-dropdown" [(ngModel)]="filterPriority">
    <option value="all">All Priority</option>
    @for (priority of priorities; track priority) {
        <option value="priority">{{priority}}</option>
    }
</select>

<label style="display: flex; align-items: center; gap: 8px" for="showCompletedTasks">
<input type="checkbox" [(ngModel)] = "showCompleted" id="showCompletedTasks"/>
Show Completed Tasks
</label>
</div>
<!--Quick action bars ends-->

<!--Producttivity alert starts-->
@switch (getProductivityLevel()) {
    @case ('excellent') {
        <div class="alert alert-success">
            [SUCCESS] Outstanding productivity!
            Keep up the great work!
        </div>
    }
    @case ('good') {
        <div class="alert alert-info">
            [GOOD] Good job!
            You're maintaining steady progress!
        </div>
    }
    @case ('needs-improvement') {
        <div class="alert alert-warning">
            [WARNING] Your productivity could use a boost!
            Focus on completing tasks!
        </div>
    }
    @case ('poor') {
        <div class="alert alert-danger">
            [ALERT] Time to get back on track!
            Start with small, easy tasks!
        </div>
    }
    @default {
        <div class="alert alert-info">
            Keep tracking your tasks!
        </div>
    }
}
<!--Producttivity alert ends-->

<!--Add task section starts-->
<div class="add-task-section">
    <div class="add-task-header">
        <h2>Add New Task</h2>
    </div>
    <div class="form-grid">

        <div class="form-group">
            <label>Title *</label>
            <input type="text" [(ngModel)]="newTask.title" placeholder="Enter task title"
            name="task-title" required (focus)="onFieldFocus('title')" (blur)="onFieldBlur('title')"/>
        </div>

        <div class="form-group">
            <label>Category *</label>
            <select [(ngModel)]="newTask.category" required>
                <option value="" disabled>Select Category</option>
                @for (category of categories; track category)
                {
                    <option [value]="category">{{category}}</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label>Priority</label>
            <select [(ngModel)]="newTask.priority">
            @for (priority of priorities; track priority) 
            {
                <option [value]="priority">{{priority}}</option>
            }
            </select>
        </div>

        <div class="form-group">
            <label>Due Date *</label>
            <input type="date" [(ngModel)]="newTask.dueDate" required/>
        </div>

        <div class="form-group">
            <label>Status</label>
            <select [(ngModel)]="newTask.status">
                @for (status of statuses; track status) 
                {
                    <option [value]="status">{{status}}</option>
                }
            </select>
        </div>

        <div class="form-group" style="grid-column: 1 / -1;">
            <label>Description</label>
            <textarea [(ngModel)]="newTask.description" placeholder="Enter task description (optional)"></textarea>
        </div>
    </div>

    <div class="form-actions">
        <button class="btn btn-primary" (click)="addTask()" 
        [disabled]="!newTask.title || !newTask.category || !newTask.dueDate"
        [title]="(!newTask.title || !newTask.category || !newTask.dueDate) ? 'Please fill required field:' : 'Add new task'">
        Add Task
        </button>
        <button class="btn btn-secondary" (click)="clearForm()">Clear</button>
    </div>
</div>
<!--Add task section ends-->

<!--Task list start-->
<div class="tasks-section">
    <div class="section-header">
        <h2>Tasks</h2>
        <span>Showing {{getFilteredTasks().length}} tasks</span>
    </div>

    @if (getFilteredTasks().length > 0) 
    {
        <div class="tasks-list">
            @for (task of getFilteredTasks(); track task.id; let idx = $index) 
            {
                <div class="task-item"
                [class]="'priority-' + task.priority">
                {{task.title}}
                </div>
            }
        </div>
    }
</div>
<!--Task list end-->

<!--header section ends-->
</div>